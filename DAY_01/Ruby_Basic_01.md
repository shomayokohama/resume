# Rubyの基礎（１）
Ruby on Rails開発に必要最低限のRuby知識を記載しています。より詳しくRubyを学びたいかたは、[たのしいRuby](http://www.amazon.co.jp/dp/4797372273)がおすすめです。

## 基本
- `hoge.rb`ように、rbの拡張子がついたファイルをつくる
- `hoge.rb`と同じディレクトリ内で`$ ruby hoge.rb`とコマンドをたたくと、`hoge.rb`内に書いてあるRubyプログラムが動作する。


```ruby:hoge.rb
puts("スパルタキャンプへようこそ！")
```

- `puts`がメソッド
	- オブジェクトがもっている機能を呼び出すこと
	- putsは文字列オブジェクトを改行付きで出力する機能
- `()`で囲まれた部分が引数（ひきすう）
	- メソッドに指定する数値や文字列
- `""`で囲まれた部分は文字列オブジェクト

## 変数
数値や文字列などを入れる「箱」のようなもの。箱にラベルをつけるイメージが変数。

```ruby
today = "2015/06/06"
puts today
```

### １．変数の種類
変数にはいくつか種類がある。

変数名|種類|
-----|----|
sparta|ローカル変数|
$sparta|グローバル変数|
@sparta|インスタンス変数|
@@sparta|クラス変数|
SPARTA|定数|

- ローカル変数とインスタンス変数が最重要

### ２．命名規則
- すべて半角のアルファベット、数値、`_`のどれかしか使えない
- 最初の文字はアルファベットか`_`
	- `1st_hoge`、`2nd_hoge`など数字始まりはエラー
- 単語のつなぎ目は`_`
	- 例：`sparta_camp`
- 自分の名前を格納する変数を作って、`puts`してみよう

## コメント
### １．一行コメントアウト
`#`以降はコメントアウトされる。

```ruby
puts "コメントテスト"
# なにを書いても無視されます
puts "コメントテスト"
```

下記の面でよく使う。

- なぜこのプログラムを書いているかの説明（未来の自分やチームメンバー向け）
- デバッグ中に、プログラムの一部を簡易的に読み込ませないようにする

なお、Sublime Textでは`command + /`で選択行がコメントイン／コメントアウトされる。便利。

### ２．複数行コメントアウト
あまり使わないけど、押さえておこう。

```ruby
puts "コメントテスト"
=begin
  puts "この間は"
  puts "何を書いても無視されます。"
=end
puts "コメントテスト"
```

## 数値
次の演算子で計算が可能。

演算子|内容|
-----|----|
+|足し算|
-|引き算|
*|かけ算|
/|割り算|
%|余り|

## 文字列
二重引用符か一重引用符で文字列を表す。

```ruby
puts "これは文字列です"
puts 'これも文字列です'
puts 100 # これは数値
puts "100" # これは文字列
```

### 式展開
二重引用符の中では、`#{式}`で中の式が文字列に展開される。

```ruby
koushi = "名城"
puts "スパルタキャンプの講師は#{koushi}です"
```

一重引用符では使えない。注意。

### シンボル
シンボルとは、一意性のある文字列。`:`をつけるとシンボルになる。`:login_user`など。
シンボルを使うとメモリ効率が良くなる。

Railsでめちゃくちゃ使われる。とりあえず文字列の仲間と考えてOK。

## 配列とハッシュ
### １．配列（Array）
データを入れておく「箱（変数）」の中に仕切りを作って分けられるようにするもの。

- `配列名[インデックス] = 格納したいオブジェクト`が基本セット
- 配列に入れた順に番号（インデックスと言います）がふられる
	- インデックスは`0`からスタートする。はじめは勘違いしやすいので注意！

```ruby
yamanote = ["新宿", "池袋", "東京", "品川", "大崎"]
# 配列名[番号]でアクセスできる。
puts yamanote[0]
=> 新宿
puts yamanote[5]
=> nil

yamanote[5] = "渋谷"
puts yamanote[5]
=> 渋谷

# 配列の大きさを調べるにはsizeメソッド
yamanote.size
=> 5

# 同じ配列に複数種類のオブジェクトを格納できる
caos = [34, "foo", true, 4.3]

```

配列の入れ子も可能

```ruby
ireko = [[405, 123], [543, 764, 677], [24, 5]]
p ireko[1][1]
=> 764

```

### ２．ハッシュ（Hash）
配列とほぼ同じだが、番号管理ではなくラベル管理となっている。ラベル名を「キー」と呼び、キーは自分で決める。

- `"キー" => 値`が基本セット。
	- `:キー => 値`でもOK。シンボルをキーとしている。
- 基本セットを`{}`で囲む
	- 配列は要素を`[]`で囲む。違いに注意！
- `ハッシュ名[”キー”]`か`ハッシュ名[:キー]`で取り出せる。

```ruby
fruits = { "apple" => 200, "orange" => 150, "cherry" => 300 }
puts fruits["orange"]
=> 150

# シンボル版
login_user = { :id => 372, :name => "Daisuke", :email => "n@wmegane.com", :DM => true }
puts login_user[:name]
=> "Daisuke"
``` 

ややこしいけど、次のようにキーの名前の (前ではなく) 後にコロンを置き、その後に値が続くような書き方もできる。**Railsはこちらが多い**。

```ruby
rails_login_user = { id: 372, name: "Daisuke", email: "n@wmegane.com", DM: true }
puts rails_login_user[:DM]
=> true
``` 

入れ子も可能。

```ruby
all_user = {
	:nashirox => { :id => 372, :name => "Daisuke", :email => "n@wmegane.com", :DM => true },
	:mohira =>   { :id => 264, :name => "Ohira", :email => "ohira@nowall.com", :DM => false }
}

all_user[:mohira][:id]
=> 264
```
